import os

from virustotal3 import core

API_KEY = os.environ['VT_API']


class CheckIp:
    def __init__(self, ip):
        self.ip = ip
        self.harmless_points = 0
        self.malicious_points = 0
        self.suspicious = 0
        self.vt = core.IP(API_KEY)

    def check(self):
        result = self.vt.info_ip(ip=self.ip, timeout=500)
        last_analysis_stats = result['data']['attributes']['last_analysis_stats']
        self.harmless_points = last_analysis_stats['harmless']
        self.malicious_points = last_analysis_stats['malicious']
        print(self.harmless_points, self.malicious_points)

    def get_point(self):
        points = self.harmless_points - 4 * self.malicious_points
        if points < 0:
            return -points / 4
        else:
            return 0


ip = CheckIp('8.8.8.8')
ip.check()
